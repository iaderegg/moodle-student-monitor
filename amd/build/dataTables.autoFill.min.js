function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(a){if("function"==typeof define&&define.amd){define ("report_studentmonitor/dataTables.autoFill",["jquery","report_studentmonitor/jquery.dataTables"],function(b){return a(b,window,document)})}else if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))){module.exports=function(b,c){if(!b){b=window}if(!c||!c.fn.dataTable){c=require("report_studentmonitor/jquery.dataTables")(b,c).$}return a(c,b,b.document)}}else{a(jQuery,window,document)}})(function(a,b,c){'use strict';var d=a.fn.dataTable,e=0,f=function(b,c){if(!d.versionCheck||!d.versionCheck("1.10.8")){throw"Warning: AutoFill requires DataTables 1.10.8 or greater"}this.c=a.extend(!0,{},d.defaults.autoFill,f.defaults,c);this.s={dt:new d.Api(b),namespace:".autoFill"+e++,scroll:{},scrollInterval:null,handle:{height:0,width:0},enabled:!1};this.dom={handle:a("<div class=\"dt-autofill-handle\"/>"),select:{top:a("<div class=\"dt-autofill-select top\"/>"),right:a("<div class=\"dt-autofill-select right\"/>"),bottom:a("<div class=\"dt-autofill-select bottom\"/>"),left:a("<div class=\"dt-autofill-select left\"/>")},background:a("<div class=\"dt-autofill-background\"/>"),list:a("<div class=\"dt-autofill-list\">"+this.s.dt.i18n("autoFill.info","")+"<ul/></div>"),dtScroll:null,offsetParent:null};this._constructor()};a.extend(f.prototype,{enabled:function enabled(){return this.s.enabled},enable:function enable(a){var b=this;if(!1===a){return this.disable()}this.s.enabled=!0;this._focusListener();this.dom.handle.on("mousedown",function(a){b._mousedown(a);return!1});return this},disable:function disable(){this.s.enabled=!1;this._focusListenerRemove();return this},_constructor:function _constructor(){var b=this,c=this.s.dt,d=a("div.dataTables_scrollBody",this.s.dt.table().container());c.settings()[0].autoFill=this;if(d.length){this.dom.dtScroll=d;if("static"===d.css("position")){d.css("position","relative")}}if(!1!==this.c.enable){this.enable()}c.on("destroy.autoFill",function(){b._focusListenerRemove()})},_attach:function _attach(b){var c=this.s.dt,d=c.cell(b).index(),e=this.dom.handle,f=this.s.handle;if(!d||-1===c.columns(this.c.columns).indexes().indexOf(d.column)){this._detach();return}if(!this.dom.offsetParent){this.dom.offsetParent=a(c.table().node()).offsetParent()}if(!f.height||!f.width){e.appendTo("body");f.height=e.outerHeight();f.width=e.outerWidth()}var g=this._getPosition(b,this.dom.offsetParent);this.dom.attachedTo=b;e.css({top:g.top+b.offsetHeight-f.height,left:g.left+b.offsetWidth-f.width}).appendTo(this.dom.offsetParent)},_actionSelector:function _actionSelector(b){var c=this,d=this.s.dt,e=f.actions,g=[];a.each(e,function(a,c){if(c.available(d,b)){g.push(a)}});if(1===g.length&&!1===this.c.alwaysAsk){var h=e[g[0]].execute(d,b);this._update(h,b)}else if(1<g.length){var j=this.dom.list.children("ul").empty();g.push("cancel");a.each(g,function(g,h){j.append(a("<li/>").append("<div class=\"dt-autofill-question\">"+e[h].option(d,b)+"<div>").append(a("<div class=\"dt-autofill-button\">").append(a("<button class=\""+f.classes.btn+"\">"+d.i18n("autoFill.button","&gt;")+"</button>").on("click",function(){var f=e[h].execute(d,b,a(this).closest("li"));c._update(f,b);c.dom.background.remove();c.dom.list.remove()}))))});this.dom.background.appendTo("body");this.dom.list.appendTo("body");this.dom.list.css("margin-top",-1*(this.dom.list.outerHeight()/2))}},_detach:function _detach(){this.dom.attachedTo=null;this.dom.handle.detach()},_drawSelection:function _drawSelection(b){var c=this.s.dt,d=this.s.start,e=a(this.dom.start),f={row:this.c.vertical?c.rows({page:"current"}).nodes().indexOf(b.parentNode):d.row,column:this.c.horizontal?a(b).index():d.column},g=c.column.index("toData",f.column),h=c.row(":eq("+f.row+")",{page:"current"}),i=a(c.cell(h.index(),g).node());if(!c.cell(i).any()){return}if(-1===c.columns(this.c.columns).indexes().indexOf(g)){return}this.s.end=f;var j,k,l,m,n,o;j=d.row<f.row?e:i;k=d.row<f.row?i:e;l=d.column<f.column?e:i;m=d.column<f.column?i:e;j=this._getPosition(j.get(0)).top;l=this._getPosition(l.get(0)).left;n=this._getPosition(k.get(0)).top+k.outerHeight()-j;o=this._getPosition(m.get(0)).left+m.outerWidth()-l;var p=this.dom.select;p.top.css({top:j,left:l,width:o});p.left.css({top:j,left:l,height:n});p.bottom.css({top:j+n,left:l,width:o});p.right.css({top:j,left:l+o,height:n})},_editor:function _editor(a){var b=this.s.dt,c=this.c.editor;if(!c){return}for(var d={},e=[],f=c.fields(),g=0,h=a.length;g<h;g++){for(var l=0,m=a[g].length;l<m;l++){var n=a[g][l],o=b.settings()[0].aoColumns[n.index.column],p=o.editField;if(p===void 0){for(var q=o.mData,r=0,s=f.length,t;r<s;r++){t=c.field(f[r]);if(t.dataSrc()===q){p=t.name();break}}}if(!p){throw"Could not automatically determine field data. Please see https://datatables.net/tn/11"}if(!d[p]){d[p]={}}var u=b.row(n.index.row).id();d[p][u]=n.set;e.push(n.index)}}c.bubble(e,!1).multiSet(d).submit()},_emitEvent:function _emitEvent(b,c){this.s.dt.iterator("table",function(d){a(d.nTable).triggerHandler(b+".dt",c)})},_focusListener:function _focusListener(){var b=this,d=this.s.dt,e=this.s.namespace,f=null!==this.c.focus?this.c.focus:d.init().keys||d.settings()[0].keytable?"focus":"hover";if("focus"===f){d.on("key-focus.autoFill",function(a,c,d){b._attach(d.node())}).on("key-blur.autoFill",function(){b._detach()})}else if("click"===f){a(d.table().body()).on("click"+e,"td, th",function(){b._attach(this)});a(c.body).on("click"+e,function(c){if(!a(c.target).parents().filter(d.table().body()).length){b._detach()}})}else{a(d.table().body()).on("mouseenter"+e,"td, th",function(){b._attach(this)}).on("mouseleave"+e,function(c){if(a(c.relatedTarget).hasClass("dt-autofill-handle")){return}b._detach()})}},_focusListenerRemove:function _focusListenerRemove(){var b=this.s.dt;b.off(".autoFill");a(b.table().body()).off(this.s.namespace);a(c.body).off(this.s.namespace)},_getPosition:function _getPosition(b,c){var d=b,e,f=0,g=0;if(!c){c=a(a(this.s.dt.table().node())[0].offsetParent)}do{var h=d.offsetTop,i=d.offsetLeft;e=a(d.offsetParent);f+=h+1*parseInt(e.css("border-top-width"));g+=i+1*parseInt(e.css("border-left-width"));if("body"===d.nodeName.toLowerCase()){break}d=e.get(0)}while(e.get(0)!==c.get(0));return{top:f,left:g}},_mousedown:function _mousedown(d){var f=this,g=this.s.dt;this.dom.start=this.dom.attachedTo;this.s.start={row:g.rows({page:"current"}).nodes().indexOf(a(this.dom.start).parent()[0]),column:a(this.dom.start).index()};a(c.body).on("mousemove.autoFill",function(a){f._mousemove(a)}).on("mouseup.autoFill",function(a){f._mouseup(a)});var e=this.dom.select,h=a(g.table().node()).offsetParent();e.top.appendTo(h);e.left.appendTo(h);e.right.appendTo(h);e.bottom.appendTo(h);this._drawSelection(this.dom.start,d);this.dom.handle.css("display","none");var i=this.dom.dtScroll;this.s.scroll={windowHeight:a(b).height(),windowWidth:a(b).width(),dtTop:i?i.offset().top:null,dtLeft:i?i.offset().left:null,dtHeight:i?i.outerHeight():null,dtWidth:i?i.outerWidth():null}},_mousemove:function _mousemove(a){var b=this,c=this.s.dt,d=a.target.nodeName.toLowerCase();if("td"!==d&&"th"!==d){return}this._drawSelection(a.target,a);this._shiftScroll(a)},_mouseup:function _mouseup(b){a(c.body).off(".autoFill");var d=this,e=this.s.dt,f=this.dom.select;f.top.remove();f.left.remove();f.right.remove();f.bottom.remove();this.dom.handle.css("display","block");var g=this.s.start,h=this.s.end;if(g.row===h.row&&g.column===h.column){return}var i=e.cell(":eq("+g.row+")",g.column+":visible",{page:"current"});if(a("div.DTE",i.node()).length){var j=e.editor();j.on("submitSuccess.dtaf close.dtaf",function(){j.off(".dtaf");setTimeout(function(){d._mouseup(b)},100)}).on("submitComplete.dtaf preSubmitCancelled.dtaf close.dtaf",function(){j.off(".dtaf")});j.submit();return}for(var k=this._range(g.row,h.row),l=this._range(g.column,h.column),m=[],n=e.settings()[0],o=n.aoColumns,p=e.columns(this.c.columns).indexes(),q=0;q<k.length;q++){m.push(a.map(l,function(a){var b=e.row(":eq("+k[q]+")",{page:"current"}),c=e.cell(b.index(),a+":visible"),d=c.data(),f=c.index(),g=o[f.column].editField;if(g!==void 0){d=n.oApi._fnGetObjectDataFn(g)(e.row(f.row).data())}if(-1===p.indexOf(f.column)){return}return{cell:c,data:d,label:c.data(),index:f}}))}this._actionSelector(m);clearInterval(this.s.scrollInterval);this.s.scrollInterval=null},_range:function _range(a,b){var c=[],d;if(a<=b){for(d=a;d<=b;d++){c.push(d)}}else{for(d=a;d>=b;d--){c.push(d)}}return c},_shiftScroll:function _shiftScroll(a){var b=this,d=this.s.dt,e=this.s.scroll,f=!1,g=5,h=65,i=a.pageY-c.body.scrollTop,j=a.pageX-c.body.scrollLeft,k,l,m,n;if(i<h){k=-1*g}else if(i>e.windowHeight-h){k=g}if(j<h){l=-1*g}else if(j>e.windowWidth-h){l=g}if(null!==e.dtTop&&a.pageY<e.dtTop+h){m=-1*g}else if(null!==e.dtTop&&a.pageY>e.dtTop+e.dtHeight-h){m=g}if(null!==e.dtLeft&&a.pageX<e.dtLeft+h){n=-1*g}else if(null!==e.dtLeft&&a.pageX>e.dtLeft+e.dtWidth-h){n=g}if(k||l||m||n){e.windowVert=k;e.windowHoriz=l;e.dtVert=m;e.dtHoriz=n;f=!0}else if(this.s.scrollInterval){clearInterval(this.s.scrollInterval);this.s.scrollInterval=null}if(!this.s.scrollInterval&&f){this.s.scrollInterval=setInterval(function(){if(e.windowVert){c.body.scrollTop+=e.windowVert}if(e.windowHoriz){c.body.scrollLeft+=e.windowHoriz}if(e.dtVert||e.dtHoriz){var a=b.dom.dtScroll[0];if(e.dtVert){a.scrollTop+=e.dtVert}if(e.dtHoriz){a.scrollLeft+=e.dtHoriz}}},20)}},_update:function _update(a,b){if(!1===a){return}var c=this.s.dt,d,e=c.columns(this.c.columns).indexes();this._emitEvent("preAutoFill",[c,b]);this._editor(b);var f=null!==this.c.update?this.c.update:this.c.editor?!1:!0;if(f){for(var g=0,h=b.length;g<h;g++){for(var k=0,l=b[g].length;k<l;k++){d=b[g][k];if(-1!==e.indexOf(d.index.column)){d.cell.data(d.set)}}}c.draw(!1)}this._emitEvent("autoFill",[c,b])}});f.actions={increment:{available:function available(a,b){var c=b[0][0].label;return!isNaN(c-parseFloat(c))},option:function option(a){return a.i18n("autoFill.increment","Increment / decrement each cell by: <input type=\"number\" value=\"1\">")},execute:function execute(b,c,d){for(var e=1*c[0][0].data,f=1*a("input",d).val(),g=0,h=c.length;g<h;g++){for(var k=0,l=c[g].length;k<l;k++){c[g][k].set=e;e+=f}}}},fill:{available:function available(){return!0},option:function option(a,b){return a.i18n("autoFill.fill","Fill all cells with <i>"+b[0][0].label+"</i>")},execute:function execute(a,b){for(var c=b[0][0].data,d=0,e=b.length;d<e;d++){for(var f=0,g=b[d].length;f<g;f++){b[d][f].set=c}}}},fillHorizontal:{available:function available(a,b){return 1<b.length&&1<b[0].length},option:function option(a){return a.i18n("autoFill.fillHorizontal","Fill cells horizontally")},execute:function execute(a,b){for(var c=0,d=b.length;c<d;c++){for(var e=0,f=b[c].length;e<f;e++){b[c][e].set=b[c][0].data}}}},fillVertical:{available:function available(a,b){return 1<b.length},option:function option(a){return a.i18n("autoFill.fillVertical","Fill cells vertically")},execute:function execute(a,b){for(var c=0,d=b.length;c<d;c++){for(var e=0,f=b[c].length;e<f;e++){b[c][e].set=b[0][e].data}}}},cancel:{available:function available(){return!1},option:function option(a){return a.i18n("autoFill.cancel","Cancel")},execute:function execute(){return!1}}};f.version="2.3.5";f.defaults={alwaysAsk:!1,focus:null,columns:"",enable:!0,update:null,editor:null,vertical:!0,horizontal:!0};f.classes={btn:"btn"};var g=a.fn.dataTable.Api;g.register("autoFill()",function(){return this});g.register("autoFill().enabled()",function(){var a=this.context[0];return a.autoFill?a.autoFill.enabled():!1});g.register("autoFill().enable()",function(a){return this.iterator("table",function(b){if(b.autoFill){b.autoFill.enable(a)}})});g.register("autoFill().disable()",function(){return this.iterator("table",function(a){if(a.autoFill){a.autoFill.disable()}})});a(c).on("preInit.dt.autofill",function(b,c){if("dt"!==b.namespace){return}var e=c.oInit.autoFill,g=d.defaults.autoFill;if(e||g){var h=a.extend({},e,g);if(!1!==e){new f(c,h)}}});d.AutoFill=f;d.AutoFill=f;return f});
//# sourceMappingURL=dataTables.autoFill.min.js.map
