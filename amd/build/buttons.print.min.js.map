{"version":3,"sources":["../src/buttons.print.js"],"names":["factory","define","amd","$","window","document","exports","module","root","fn","dataTable","require","Buttons","jQuery","DataTable","_link","createElement","_styleToAbs","el","clone","nodeName","toLowerCase","href","_relToAbs","outerHTML","linkHost","host","indexOf","pathname","protocol","search","ext","buttons","print","className","text","dt","i18n","action","e","button","config","data","exportData","extend","decodeEntities","exportOptions","exportInfo","columnClasses","columns","flatten","map","idx","settings","aoColumns","column","index","sClass","toArray","addRow","d","tag","str","i","ien","length","dataOut","classAttr","html","table","node","header","body","footer","win","open","close","head","title","each","innerHTML","messageTop","messageBottom","addClass","img","setAttribute","getAttribute","customize","autoPrint","navigator","userAgent","match","setTimeout"],"mappings":"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","sourcesContent":["/*!\n * Print button for Buttons and DataTables.\n * 2016 SpryMedia Ltd - datatables.net/license\n */\n\n(function( factory ){\n\tif ( typeof define === 'function' && define.amd ) {\n\t\t// AMD\n\t\tdefine( ['jquery', 'report_studentmonitor/jquery.dataTables', 'report_studentmonitor/dataTables.buttons'], function ( $ ) {\n\t\t\treturn factory( $, window, document );\n\t\t} );\n\t}\n\telse if ( typeof exports === 'object' ) {\n\t\t// CommonJS\n\t\tmodule.exports = function (root, $) {\n\t\t\tif ( ! root ) {\n\t\t\t\troot = window;\n\t\t\t}\n\n\t\t\tif ( ! $ || ! $.fn.dataTable ) {\n\t\t\t\t$ = require('report_studentmonitor/jquery.dataTables')(root, $).$;\n\t\t\t}\n\n\t\t\tif ( ! $.fn.dataTable.Buttons ) {\n\t\t\t\trequire('report_studentmonitor/dataTables.buttons')(root, $);\n\t\t\t}\n\n\t\t\treturn factory( $, root, root.document );\n\t\t};\n\t}\n\telse {\n\t\t// Browser\n\t\tfactory( jQuery, window, document );\n\t}\n}(function( $, window, document, undefined ) {\n'use strict';\nvar DataTable = $.fn.dataTable;\n\n\nvar _link = document.createElement( 'a' );\n\n/**\n * Clone link and style tags, taking into account the need to change the source\n * path.\n *\n * @param  {node}     el Element to convert\n */\nvar _styleToAbs = function( el ) {\n\tvar url;\n\tvar clone = $(el).clone()[0];\n\tvar linkHost;\n\n\tif ( clone.nodeName.toLowerCase() === 'link' ) {\n\t\tclone.href = _relToAbs( clone.href );\n\t}\n\n\treturn clone.outerHTML;\n};\n\n/**\n * Convert a URL from a relative to an absolute address so it will work\n * correctly in the popup window which has no base URL.\n *\n * @param  {string} href URL\n */\nvar _relToAbs = function( href ) {\n\t// Assign to a link on the original page so the browser will do all the\n\t// hard work of figuring out where the file actually is\n\t_link.href = href;\n\tvar linkHost = _link.host;\n\n\t// IE doesn't have a trailing slash on the host\n\t// Chrome has it on the pathname\n\tif ( linkHost.indexOf('/') === -1 && _link.pathname.indexOf('/') !== 0) {\n\t\tlinkHost += '/';\n\t}\n\n\treturn _link.protocol+\"//\"+linkHost+_link.pathname+_link.search;\n};\n\n\nDataTable.ext.buttons.print = {\n\tclassName: 'buttons-print',\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.print', 'Print' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\tvar data = dt.buttons.exportData(\n\t\t\t$.extend( {decodeEntities: false}, config.exportOptions ) // XSS protection\n\t\t);\n\t\tvar exportInfo = dt.buttons.exportInfo( config );\n\t\tvar columnClasses = dt\n\t\t\t.columns( config.exportOptions.columns )\n\t\t\t.flatten()\n\t\t\t.map( function (idx) {\n\t\t\t\treturn dt.settings()[0].aoColumns[dt.column(idx).index()].sClass;\n\t\t\t} )\n\t\t\t.toArray();\n\n\t\tvar addRow = function ( d, tag ) {\n\t\t\tvar str = '<tr>';\n\n\t\t\tfor ( var i=0, ien=d.length ; i<ien ; i++ ) {\n\t\t\t\t// null and undefined aren't useful in the print output\n\t\t\t\tvar dataOut = d[i] === null || d[i] === undefined ?\n\t\t\t\t\t'' :\n\t\t\t\t\td[i];\n\t\t\t\tvar classAttr = columnClasses[i] ?\n\t\t\t\t\t'class=\"'+columnClasses[i]+'\"' :\n\t\t\t\t\t'';\n\n\t\t\t\tstr += '<'+tag+' '+classAttr+'>'+dataOut+'</'+tag+'>';\n\t\t\t}\n\n\t\t\treturn str + '</tr>';\n\t\t};\n\n\t\t// Construct a table for printing\n\t\tvar html = '<table class=\"'+dt.table().node().className+'\">';\n\n\t\tif ( config.header ) {\n\t\t\thtml += '<thead>'+ addRow( data.header, 'th' ) +'</thead>';\n\t\t}\n\n\t\thtml += '<tbody>';\n\t\tfor ( var i=0, ien=data.body.length ; i<ien ; i++ ) {\n\t\t\thtml += addRow( data.body[i], 'td' );\n\t\t}\n\t\thtml += '</tbody>';\n\n\t\tif ( config.footer && data.footer ) {\n\t\t\thtml += '<tfoot>'+ addRow( data.footer, 'th' ) +'</tfoot>';\n\t\t}\n\t\thtml += '</table>';\n\n\t\t// Open a new window for the printable table\n\t\tvar win = window.open( '', '' );\n\t\twin.document.close();\n\n\t\t// Inject the title and also a copy of the style and link tags from this\n\t\t// document so the table can retain its base styling. Note that we have\n\t\t// to use string manipulation as IE won't allow elements to be created\n\t\t// in the host document and then appended to the new window.\n\t\tvar head = '<title>'+exportInfo.title+'</title>';\n\t\t$('style, link').each( function () {\n\t\t\thead += _styleToAbs( this );\n\t\t} );\n\n\t\ttry {\n\t\t\twin.document.head.innerHTML = head; // Work around for Edge\n\t\t}\n\t\tcatch (e) {\n\t\t\t$(win.document.head).html( head ); // Old IE\n\t\t}\n\n\t\t// Inject the table and other surrounding information\n\t\twin.document.body.innerHTML =\n\t\t\t'<h1>'+exportInfo.title+'</h1>'+\n\t\t\t'<div>'+(exportInfo.messageTop || '')+'</div>'+\n\t\t\thtml+\n\t\t\t'<div>'+(exportInfo.messageBottom || '')+'</div>';\n\n\t\t$(win.document.body).addClass('dt-print-view');\n\n\t\t$('img', win.document.body).each( function ( i, img ) {\n\t\t\timg.setAttribute( 'src', _relToAbs( img.getAttribute('src') ) );\n\t\t} );\n\n\t\tif ( config.customize ) {\n\t\t\tconfig.customize( win, config, dt );\n\t\t}\n\n\t\t// Allow stylesheets time to load\n\t\tvar autoPrint = function () {\n\t\t\tif ( config.autoPrint ) {\n\t\t\t\twin.print(); // blocking - so close will not\n\t\t\t\twin.close(); // execute until this is done\n\t\t\t}\n\t\t};\n\n\t\tif ( navigator.userAgent.match(/Trident\\/\\d.\\d/) ) { // IE needs to call this without a setTimeout\n\t\t\tautoPrint();\n\t\t}\n\t\telse {\n\t\t\twin.setTimeout( autoPrint, 1000 );\n\t\t}\n\t},\n\n\ttitle: '*',\n\n\tmessageTop: '*',\n\n\tmessageBottom: '*',\n\n\texportOptions: {},\n\n\theader: true,\n\n\tfooter: false,\n\n\tautoPrint: true,\n\n\tcustomize: null\n};\n\n\nreturn DataTable.Buttons;\n}));\n"],"file":"buttons.print.min.js"}